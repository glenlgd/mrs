# 支持滚动重启<a name="ZH-CN_TOPIC_0138965094"></a>

在修改了大数据组件的配置项后，需要重启对应的服务来使得配置生效，使用普通重启方式会并发重启所有服务或实例，可能引起业务断服。为了确保服务重启过程中，尽量减少或者不影响业务运行，可以通过滚动重启来按批次重启服务或实例（对于有主备状态的实例，会先重启备实例，再重启主实例）。滚动重启方式的重启时间比普通重启时间久。

当前MRS集群中，以下服务或者进程不支持滚动重启：SparkResource 、Hue、Loader。

## 滚动重启服务<a name="section1115494813176"></a>

1.  在MRS Manager，单击“服务管理“，选择需要滚动重启的服务，进入服务页面。
2.  在“服务状态“页签单击“更多“，选择“滚动重启服务“。

    **图 1**  服务状态<a name="fig52384549199"></a>  
    ![](figures/服务状态.png "服务状态")

3.  输入管理员密码后，弹出“滚动重启服务“页面，勾选“仅重启配置过期的实例“，单击确认，开始滚动重启服务。

    **图 2**  滚动重启服务配置<a name="fig06173218146"></a>  
    ![](figures/滚动重启服务配置.png "滚动重启服务配置")

4.  滚动重启任务完成后，单击“完成“。

    **图 3**  滚动重启服务完成<a name="fig365595251413"></a>  
    ![](figures/滚动重启服务完成.png "滚动重启服务完成")


## 滚动重启实例<a name="section938837152120"></a>

1.  在MRS Manager，单击“服务管理“，选择需要滚动重启的服务，进入服务页面。
2.  在“实例“页签，勾选要重启的实例，单击“更多“，选择“滚动重启实例“。

    **图 4**  服务实例<a name="fig76411828112213"></a>  
    ![](figures/服务实例.png "服务实例")

3.  输入管理员密码后，弹出“滚动重启实例“页面，勾选“仅重启配置过期的实例“，单击确认，开始滚动重启实例。
4.  滚动重启任务完成后，单击“完成“。

## 滚动重启集群<a name="section1787148152416"></a>

1.  在MRS Manager，单击“服务管理“，进入服务管理页面。
2.  单击“更多“，选择“滚动重启集群“。

    **图 5**  服务管理<a name="fig6325453142516"></a>  
    ![](figures/服务管理.png "服务管理")

3.  输入管理员密码后，弹出“滚动重启集群“页面，勾选“仅重启配置过期的实例“，单击确认，开始滚动重启集群。
4.  滚动重启任务完成后，单击“完成“。

## 滚动重启参数说明<a name="section289834562610"></a>

滚动重启参数说明如[表1](#table817615121520)所示。

**表 1**  滚动重启参数说明

<a name="table817615121520"></a>
<table><thead align="left"><tr id="row10176131217216"><th class="cellrowborder" valign="top" width="24.560000000000002%" id="mcps1.2.3.1.1"><p id="p1617661219217"><a name="p1617661219217"></a><a name="p1617661219217"></a>参数名称</p>
</th>
<th class="cellrowborder" valign="top" width="75.44%" id="mcps1.2.3.1.2"><p id="p1917610123214"><a name="p1917610123214"></a><a name="p1917610123214"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row8176712727"><td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.3.1.1 "><p id="p12176612228"><a name="p12176612228"></a><a name="p12176612228"></a>仅重启配置过期的实例</p>
</td>
<td class="cellrowborder" valign="top" width="75.44%" headers="mcps1.2.3.1.2 "><p id="p71761012122"><a name="p71761012122"></a><a name="p71761012122"></a>是否只重启集群内修改过配置的实例。</p>
</td>
</tr>
<tr id="row161761712825"><td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.3.1.1 "><p id="p1517601214211"><a name="p1517601214211"></a><a name="p1517601214211"></a>数据节点滚动重启并发数</p>
</td>
<td class="cellrowborder" valign="top" width="75.44%" headers="mcps1.2.3.1.2 "><p id="p1217614122025"><a name="p1217614122025"></a><a name="p1217614122025"></a><span>采用分批并发滚动重启策略的数据节点实例每一个批次重启的实例数，默认为1，取值范围为1～20。</span>只对数据节点有效。</p>
</td>
</tr>
<tr id="row1917710127217"><td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.3.1.1 "><p id="p31771112423"><a name="p31771112423"></a><a name="p31771112423"></a>批次时间间隔</p>
</td>
<td class="cellrowborder" valign="top" width="75.44%" headers="mcps1.2.3.1.2 "><p id="p1417714129215"><a name="p1417714129215"></a><a name="p1417714129215"></a>滚动重启实例批次之间的间隔时间，默认为0，取值范围为0～2147483647。</p>
</td>
</tr>
<tr id="row10177121219210"><td class="cellrowborder" valign="top" width="24.560000000000002%" headers="mcps1.2.3.1.1 "><p id="p101771612729"><a name="p101771612729"></a><a name="p101771612729"></a>批次容错阈值</p>
</td>
<td class="cellrowborder" valign="top" width="75.44%" headers="mcps1.2.3.1.2 "><p id="p11775123217"><a name="p11775123217"></a><a name="p11775123217"></a><span>滚动重启实例批次执行失败容错次数，默认为0，即表示任意一个批次的实例重启失败后，滚动重启任务终止。</span>取值范围为0～214748364。</p>
</td>
</tr>
</tbody>
</table>

## 典型场景操作步骤<a name="section830817219322"></a>

1.  在MRS Manager，单击“服务管理“，选择HBase，进入HBase服务页面。
2.  单击“服务配置“页签，修改HBase某个参数并保存配置，在出现如下弹窗后，单击“确定“进行保存。

    **图 6**  保存配置<a name="fig8181745152016"></a>  
    ![](figures/保存配置.png "保存配置")

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >不要勾选“重新启动受影响的服务或实例“，该处重启是普通重启方式，会并发重启所有服务或实例，引起业务断服。  

3.  保存配置完成后，单击“完成“。
4.  选择“服务状态“页签。
5.  在“服务状态“页签单击“更多“，选择“滚动重启服务“。

    **图 7**  服务状态-滚动重启<a name="fig1429712581880"></a>  
    ![](figures/服务状态-滚动重启.png "服务状态-滚动重启")

6.  输入管理员密码后，弹出“滚动重启服务“页面，勾选“仅重启配置过期的实例“，单击确认，开始滚动重启。

    **图 8**  配置滚动重启服务<a name="fig15979153817152"></a>  
    ![](figures/配置滚动重启服务.png "配置滚动重启服务")

7.  滚动重启任务完成后，单击“完成“。

    **图 9**  滚动重启任务完成<a name="fig17461932121619"></a>  
    ![](figures/滚动重启任务完成.png "滚动重启任务完成")


