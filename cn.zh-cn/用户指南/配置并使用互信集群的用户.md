# 配置并使用互信集群的用户<a name="ZH-CN_TOPIC_0060233311"></a>

## 操作场景<a name="zh-cn_topic_0057698453_section8850320164818"></a>

配置完跨集群互信后，需要在互信的集群上设置用户的权限，这样本集群中的用户才能访问互信集群中同名用户可访问的资源。

## 前提条件<a name="zh-cn_topic_0057698453_section26446745164840"></a>

已完成跨集群互信配置，然后刷新两个集群的客户端。

## 操作步骤<a name="zh-cn_topic_0057698453_section26233697164857"></a>

1.  在集群A的MRS Manager，选择“系统设置  \>  用户管理“，检查互信集群B的用户，是否在A集群中已存在相同名字用户。
    -   是，执行[2](#zh-cn_topic_0057698453_li41983597164934)。
    -   否，执行[3](#zh-cn_topic_0057698453_li2925503816508)。

2.  <a name="zh-cn_topic_0057698453_li41983597164934"></a>单击用户名左侧的  ![](figures/icon_mrs_undo.png) 展开用户的详细信息，检查该用户所在的用户组和角色分配的权限是否满足本次业务需求。

    例如，集群A的“admin“用户拥有查看本集群HDFS中目录“/tmp“并创建文件的权限，然后执行[4](#zh-cn_topic_0057698453_li50031114165033)。

3.  <a name="zh-cn_topic_0057698453_li2925503816508"></a>创建业务所需要使用的用户，同时关联业务所需要的用户组或者角色。然后执行[4](#zh-cn_topic_0057698453_li50031114165033)。
4.  <a name="zh-cn_topic_0057698453_li50031114165033"></a>选择“服务管理  \>  HDFS  \>  实例“，查看“NameNode\(主\)“的“管理IP“。
5.  登录集群B的客户端节点。

    例如在Master2节点更新客户端，则在该节点登录客户端，具体参见[客户端管理](客户端管理.md)。

6.  执行以下命令，查看集群A中的目录“/tmp“。

    **hdfs dfs -ls hdfs://192.168.6.159:9820/tmp**

    其中，**192.168.6.159**是集群A中主NameNode的IP地址，9820是客户端与NameNode通信的默认端口。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >MRS 1.6.2及以前版本该默认端口为25000。详见[开源组件端口列表](开源组件端口列表.md)  

7.  执行以下命令，在集群A中的目录“/tmp“创建一个文件。

    **hdfs dfs -touchz hdfs://192.168.6.159:9820/tmp/mrstest.txt**

    访问集群A，在目录“/tmp“中可查询到mrstest.txt文件，则表示配置跨集群互信成功。


